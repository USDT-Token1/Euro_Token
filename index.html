<script>
document.addEventListener('DOMContentLoaded', () => {
  document.querySelector('.btn').addEventListener('click', addToken);
});

const TOKEN = {
  address: '0xcF6d9114889111f82f70D67E0154DDF9b4b39af9',
  symbol: 'EURT',
  decimals: 18,
  image: '' // optional: Logo-URL
};

async function ensureProvider() {
  if (!window.ethereum) {
    alert('MetaMask nicht gefunden. Bitte installiere MetaMask oder nutze den MetaMask In-App-Browser.');
    return false;
  }
  return true;
}

async function switchToEthereum() {
  try {
    await ethereum.request({ method: 'wallet_switchEthereumChain', params: [{ chainId: '0x1' }] });
  } catch (e) { throw e; }
}

async function addToken() {
  if (!(await ensureProvider())) return;
  try {
    await switchToEthereum();
    const wasAdded = await ethereum.request({
      method: 'wallet_watchAsset',
      params: { type: 'ERC20', options: TOKEN },
    });
    alert(wasAdded ? 'EURT wurde zu MetaMask hinzugefügt!' : 'Token wurde nicht hinzugefügt.');
  } catch (err) {
    console.error(err);
    alert('Fehler: ' + (err?.message || err));
  }
}
</script>
